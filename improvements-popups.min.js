let exitIntentShown=!1,scrollTriggered=!1;const EXIT_INTENT_DELAY=500;let countdownInterval,scrollTimeout,countdownMinutes=10,countdownSeconds=0;function startCountdown(){const t=document.getElementById("countdown-timer");t&&(countdownInterval=setInterval(()=>{if(0===countdownSeconds){if(0===countdownMinutes)return clearInterval(countdownInterval),t.textContent="EXPIRED",void(t.style.color="#dc2626");countdownMinutes--,countdownSeconds=59}else countdownSeconds--;const e=countdownMinutes.toString().padStart(2,"0"),n=countdownSeconds.toString().padStart(2,"0");t.textContent=`${e}:${n}`},1e3))}function showExitIntent(){if(exitIntentShown)return;const t=localStorage.getItem("rateLimitStatus");if(t)try{if(JSON.parse(t).unlimited)return void console.log("Exit intent: Skipped for premium user")}catch(t){console.error("Error parsing rate limit status:",t)}const e=document.getElementById("exit-intent-popup");e&&(e.style.display="block",exitIntentShown=!0,startCountdown(),console.log("‚ú® Exit intent popup shown"),"undefined"!=typeof gtag&&gtag("event","exit_intent_shown",{event_category:"conversion",event_label:"exit_intent_popup"}))}function closeExitIntent(){const t=document.getElementById("exit-intent-popup");t&&(t.style.display="none",countdownInterval&&clearInterval(countdownInterval),console.log("Exit intent popup closed"),"undefined"!=typeof gtag&&gtag("event","exit_intent_closed",{event_category:"conversion",event_label:"exit_intent_popup"}))}function updateLastUpgrade(){const t=["Sarah","Mike","Emma","David","Sophie","Tom","Lisa","John","Anna","Peter","Laura","Mark","Julia","Chris","Nina","Alex","Maria","Paul","Kim","Frank","Eva","Lucas","Hannah","Max"],e=document.getElementById("last-upgrade-name"),n=document.getElementById("last-upgrade-time");if(e&&n){const o=t[Math.floor(Math.random()*t.length)];e.textContent=o;const i=Math.floor(43*Math.random())+2;n.textContent=`${i} min`,console.log(`‚úÖ Last upgrade: ${o} - ${i} min ago`)}}document.addEventListener("mouseout",t=>{t.clientY<10&&!exitIntentShown&&(console.log("Exit intent: Mouse out detected"),setTimeout(showExitIntent,500))}),window.addEventListener("scroll",()=>{if(scrollTriggered||exitIntentShown)return;window.scrollY/(document.documentElement.scrollHeight-window.innerHeight)*100>50&&(console.log("Exit intent: 50% scroll reached"),scrollTriggered=!0,scrollTimeout=setTimeout(()=>{showExitIntent()},3e3))}),document.getElementById("exit-intent-popup")?.addEventListener("click",t=>{"exit-intent-popup"===t.target.id&&closeExitIntent()}),document.addEventListener("keydown",t=>{"Escape"===t.key&&exitIntentShown&&closeExitIntent()}),console.log("‚úÖ Exit intent popup initialized"),updateLastUpgrade(),setInterval(()=>{updateLastUpgrade()},3e4*Math.random()+3e4);let currentTestimonial=0;const testimonials=document.querySelectorAll(".testimonial-item"),testimonialDots=document.querySelectorAll(".testimonial-dot");function showTestimonial(t){testimonials.forEach(t=>{t.style.display="none",t.classList.remove("active")}),testimonialDots.forEach(t=>{t.classList.remove("active"),t.classList.remove("bg-purple-600"),t.classList.add("bg-gray-300")}),testimonials[t]&&(testimonials[t].style.display="block",testimonials[t].classList.add("active")),testimonialDots[t]&&(testimonialDots[t].classList.add("active"),testimonialDots[t].classList.add("bg-purple-600"),testimonialDots[t].classList.remove("bg-gray-300")),currentTestimonial=t}function nextTestimonial(){showTestimonial((currentTestimonial+1)%testimonials.length)}testimonialDots.forEach((t,e)=>{t.addEventListener("click",()=>{showTestimonial(e),clearInterval(testimonialInterval),testimonialInterval=setInterval(nextTestimonial,6e3)})});let testimonialInterval=setInterval(nextTestimonial,6e3);testimonials.length>0&&(showTestimonial(0),console.log("‚úÖ Testimonial slider initialized with",testimonials.length,"testimonials"));const stickyBtn=document.getElementById("sticky-download-btn"),stickyBtnAction=document.getElementById("sticky-download-action"),stickyBtnTitle=document.getElementById("sticky-btn-title"),stickyBtnSubtitle=document.getElementById("sticky-btn-subtitle"),stickyBtnCta=document.getElementById("sticky-btn-cta");let stickyBtnVisible=!1;function updateStickyButton(){const t=window.rateLimiter?.getStatus()||{unlimited:!1};let e={whitelisted:!1,unlimited:!1,devMode:!1};try{const t=localStorage.getItem("rateLimitServerStatus");t&&(e=JSON.parse(t))}catch(t){console.error("Error parsing server status:",t)}t.unlimited||e.whitelisted?(stickyBtnTitle.textContent="Ready to Download?",stickyBtnSubtitle.textContent="Get your complete CV analysis",stickyBtnCta.textContent="Download PDF"):(stickyBtnTitle.textContent="Want Full Analysis?",stickyBtnSubtitle.textContent="Unlock all 12+ improvements + cover letter",stickyBtnCta.textContent="Upgrade Now")}function updateComparisonStats(t){const e=t-58,n=Math.round(e);let o;o=t>=90?"5%":t>=85?"10%":t>=80?"15%":t>=75?"20%":t>=70?"25%":t>=65?"30%":t>=60?"40%":"50%";const i=100-parseInt(o)+"%",s=document.getElementById("user-score-comparison"),l=document.getElementById("user-score-bar"),a=document.getElementById("improvement-percentage"),c=document.getElementById("percentile-rank"),r=document.getElementById("beat-percentage"),d=document.getElementById("motivation-title"),u=document.getElementById("motivation-message");s&&(s.textContent=t+"%"),a&&(a.textContent=n),c&&(c.textContent=o),r&&(r.textContent=i),l&&setTimeout(()=>{l.style.width=t+"%"},500),d&&u&&(t>=90?(d.textContent="Outstanding! üåü",u.textContent="You're in the top 5%! Your CV is highly competitive. Unlock Pro to get the full detailed analysis and cover letter."):t>=80?(d.textContent="Excellent work! üéâ",u.textContent="You're in the top 15%! Just a few more improvements to reach top 5%. Unlock Pro to see all suggestions."):t>=70?(d.textContent="Great progress! üí™",u.textContent="You're above average! Unlock Pro to see 12+ improvements that will push you to top 10%."):t>=60?(d.textContent="Good start! üëç",u.textContent="You're close to average. Unlock Pro to see exactly what's holding you back and how to fix it."):(d.textContent="Lots of potential! üöÄ",u.textContent="Your CV needs work, but don't worry! Unlock Pro to get 12+ specific improvements that will boost your score by 30%+.")),console.log(`‚úÖ Comparison stats updated: ${t}% (Top ${o}, beats ${i})`)}function initScarcityTimers(){const t="scarcity_timer_end";let e=localStorage.getItem(t);function n(){const o=new Date,i=new Date(e)-o;if(i<=0){const o=new Date(Date.now()+9e5).toISOString();return localStorage.setItem(t,o),e=o,n()}const s=Math.floor(i/6e4),l=`${s}:${Math.floor(i%6e4/1e3).toString().padStart(2,"0")}`,a=document.getElementById("sticky-timer");a&&(a.textContent=l);const c=document.getElementById("countdown-timer");c&&(c.textContent=l),s<3&&(a&&(a.style.animation="pulse 1s infinite"),c&&(c.style.animation="pulse 1s infinite"))}(!e||new Date(e)<new Date)&&(e=new Date(Date.now()+9e5).toISOString(),localStorage.setItem(t,e)),n(),setInterval(n,1e3),console.log("‚úÖ Scarcity timers initialized")}window.addEventListener("scroll",()=>{const t=window.scrollY;t>300&&!stickyBtnVisible?(stickyBtn.style.bottom="20px",stickyBtnVisible=!0):t<=300&&stickyBtnVisible&&(stickyBtn.style.bottom="-100px",stickyBtnVisible=!1)}),stickyBtnAction.addEventListener("click",()=>{const t=window.rateLimiter?.getStatus()||{unlimited:!1};let e={whitelisted:!1,unlimited:!1,devMode:!1};try{const t=localStorage.getItem("rateLimitServerStatus");t&&(e=JSON.parse(t))}catch(t){console.error("Error parsing server status:",t)}t.unlimited||e.whitelisted?(window.trackEvent("sticky_download_clicked",{user_type:"premium",source:"sticky_button"}),downloadPDF()):(window.trackEvent("sticky_download_clicked",{user_type:"free",source:"sticky_button"}),trackUpgradeClick("sticky_download_button"),window.location.href="/#pricing")}),setTimeout(updateStickyButton,1e3),console.log("‚úÖ Sticky download button initialized"),window.updateComparisonStats=updateComparisonStats,initScarcityTimers(),window.closeExitIntent=closeExitIntent;